(this["webpackJsonpreact-cats-app"]=this["webpackJsonpreact-cats-app"]||[]).push([[0],{103:function(t,e,a){},226:function(t,e,a){"use strict";a.r(e);var n=a(1),s=a(0),i=a.n(s),c=a(17),o=a.n(c),r=(a(103),a(7)),l=a(228),u=a(22),d=a(23),p=a(3),b=function(){function t(){Object(u.a)(this,t),this.photos=[]}return Object(d.a)(t,[{key:"setPhotos",value:function(t){this.photos=t}}]),t}(),h=new(b=Object(p.i)(b,{photos:p.n,setPhotos:p.f})),j=a(13),v=Object(j.a)(),f=a(32),m=a(61);a(65);var g=Object(l.c)((function(t){var e=t.location.pathname;return Object(n.jsxs)(f.a,{bg:"primary",expand:"lg",variant:"dark",className:"card-shadow",children:[Object(n.jsx)(f.a.Brand,{href:"/",children:"CAT API"}),Object(n.jsx)(f.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(n.jsx)(f.a.Collapse,{id:"basic-navbar-nav",children:Object(n.jsx)(m.a,{className:"mr-auto",children:Object(n.jsx)(m.a.Link,{href:"/upload",active:"/"===e,children:"Upload"})})})]})})),O=a(62),x=a(16),y=a.n(x),S=a(31),_=a(44),C=a(42),N=a(96),k=a(21),w=a.n(k),F=a(21),P="https://api.thecatapi.com",I=function(t,e){return F.get("".concat(P,"/v1/images?limit=").concat(t,"&page=").concat(e,"&order=ASC"),{headers:{"Content-Type":"multipart/form-data","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}})},A=a(90),T=a.n(A),D=a(91),L=a.n(D),V=a(92),E=a.n(V),U=a(58),B=a.n(U),M=a(93),J=a.n(M),Y=a(94),q=a.n(Y),z=a(95),G=a.n(z),H={filter:L.a,find:E.a,get:B.a,isEmpty:J.a,remove:q.a,countBy:G.a},K=function(t){Object(_.a)(a,t);var e=Object(C.a)(a);function a(){var t;return Object(u.a)(this,a),(t=e.call(this)).handlePageClick=function(e){var a=e.selected;t.setState({pagination:Object(r.a)(Object(r.a)({},t.state.pagination),{},{currentPage:a})})},t.getAllFav=Object(S.a)(y.a.mark((function e(){var a;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n=void 0,F({method:"get",url:"".concat(P,"/v1/favourites"),data:n,headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}});case 2:a=e.sent,t.setState({favourites:a.data});case 4:case"end":return e.stop()}var n}),e)}))),t.getSpecificFavourite=function(e){w.a.get("https://api.thecatapi.com/v1/favourites/".concat(e),{headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}}).then((function(e){t.setState({favourites:[].concat(Object(O.a)(t.state.favourites),[e.data])})}))},t.getAllVotes=Object(S.a)(y.a.mark((function e(){var a,n,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.get("".concat(P,"/v1/votes"),{headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}});case 2:a=e.sent,n=a.data.filter((function(t){return 1===t.value})),s=a.data.filter((function(t){return 0===t.value})),t.setState({vote_up:n.length,vote_down:s.length}),console.log("votes.data =====> ",a.data),t.setState({votes:a.data});case 8:case"end":return e.stop()}}),e)}))),t.getAllPhotos=function(){var e=Object(S.a)(y.a.mark((function e(a){var n,s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(8,a);case 2:n=e.sent,console.log("response : ",n),0===parseInt(H.get(n,"headers.pagination-page"))&&(s={total:parseInt(H.get(n,"headers.pagination-count",0)),limit:parseInt(H.get(n,"headers.pagination-limit",0)),currentPage:parseInt(H.get(n,"headers.pagination-page",0))},t.state.pagination=Object(r.a)({},s)),t.setState({photos:n.data});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.handleFavSubmit=function(){var e=Object(S.a)(y.a.mark((function e(a,n){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,w.a.post("https://api.thecatapi.com/v1/favourites",n,{headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}}).then((function(e){"SUCCESS"===H.get(e,"data.message","FAIL")&&t.getSpecificFavourite(e.data.id),localStorage.setItem("favId",e.data.id),t.setState({vote_state:1,vote:t.state.vote})}));case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),t.handleUnFavSubmit=function(e,a){e.preventDefault();var n=a;w.a.delete("https://api.thecatapi.com/v1/favourites/".concat(n),{headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}}).then((function(e){localStorage.removeItem("favId");H.remove(t.state.favourites,{id:n});t.setState({vote_state:null,favourites:Object(O.a)(t.state.favourites)})}))},t.handleVoteSubmit=function(e,a){e.preventDefault();var n=a;H.isEmpty(a.sub_id)&&(delete a.sub_id,n=a),w.a.post("https://api.thecatapi.com/v1/votes",n,{headers:{"Content-Type":"application/json","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}}).then((function(e){t.getAllVotes(),t.setState({push:1})}))},t.state={photos:[],id:"",sub_id:"",votes:"",vote_up:"",vote_down:"",vote_state:null,vote:"",visible:!1,push:null,favourites:[],pagination:{total:0,limit:8,currentPage:0}},t}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.setState({push:1}),this.getAllFav(),this.getAllPhotos(0),this.getAllVotes()}},{key:"componentDidUpdate",value:function(t,e){if(e.favourites!==this.state.favourites&&this.setState(),console.log("pagination ====> ",e.pagination,this.state.pagination),e.pagination!==this.state.pagination){var a=H.get(this.state.pagination,"currentPage",1);this.getAllPhotos(a)}}},{key:"render",value:function(){var t=this,e=this.state.pagination;console.log("this.state.photos =====> ",this.state.photos);var a=this.state.photos.map((function(e){var a={image_id:e.id};H.isEmpty(e.sub_id)||(a=Object(r.a)(Object(r.a)({},a),{},{sub_id:e.sub_id}));var s={image_id:e.id,sub_id:e.sub_id,value:!0},i={image_id:e.id,sub_id:e.sub_id,value:!1},c={};c.image_id=e.id,H.isEmpty(e.sub_id)||(c.sub_id=e.sub_id);var o=H.filter(t.state.votes,Object(r.a)(Object(r.a)({},c),{},{value:1})),l=H.filter(t.state.votes,Object(r.a)(Object(r.a)({},c),{},{value:0})),u=H.find(t.state.favourites,Object(r.a)({},a));return Object(n.jsx)("div",{className:"col-md-6 col-xl-3 mt-5",children:Object(n.jsxs)("div",{className:"cat-card card-shadow",children:[Object(n.jsxs)("div",{className:"cat-card-top",children:[Object(n.jsx)("img",{className:"cat-img",src:e.url,id:"img_wrap"},e.id),u?Object(n.jsx)("button",{type:"button",className:"fav-btn btn btn-primary btn-lg",onClick:function(e){return t.handleUnFavSubmit(e,u.id)},children:Object(n.jsx)("i",{className:"fa fa-heart"})}):Object(n.jsx)("button",{type:"button",className:"fav-btn btn btn-primary btn-lg",onClick:function(e){return t.handleFavSubmit(e,a)},children:Object(n.jsx)("i",{className:"fa fa-heart un-fa-heart"})})]}),Object(n.jsxs)("div",{className:"row mx-0",children:[Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("p",{className:"mb-2",children:Object(n.jsx)("span",{className:"total-votes totla-up-votes",children:o.length})}),Object(n.jsx)("button",{type:"button",className:"btn btn-success btn-lg w-100 vote-up",onClick:function(e){return t.handleVoteSubmit(e,s)},children:"Vote Up"})]}),Object(n.jsxs)("div",{className:"col",children:[Object(n.jsx)("p",{className:"mb-2",children:Object(n.jsx)("span",{className:"total-votes totla-down-votes",children:l.length})}),Object(n.jsx)("button",{type:"button",className:"btn btn-danger btn-lg w-100","w-100":!0,onClick:function(e){return t.handleVoteSubmit(e,i)},children:"Vote Down "})]})]})]})},e.id)})),s=(e.currentPage,Math.ceil(e.total/8));return Object(n.jsxs)("div",{className:"container",children:[Object(n.jsx)("div",{className:"row",children:a}),Object(n.jsx)("div",{className:"row mx-0 pagination-wrapper",children:Object(n.jsx)("div",{className:"col",children:!H.isEmpty(a)&&Object(n.jsx)(T.a,{previousLabel:"\u2190 Previous",nextLabel:"Next \u2192",pageCount:s,onPageChange:this.handlePageClick,containerClassName:"pagination",previousLinkClassName:"pagination__link",nextLinkClassName:"pagination__link",disabledClassName:"pagination__link--disabled",activeClassName:"pagination__link--active"})})})]})}}]),a}(i.a.Component),Q=Object(N.a)(K),R=a(30),W=a(21),X=function(t){Object(_.a)(a,t);var e=Object(C.a)(a);function a(t){var n;return Object(u.a)(this,a),(n=e.call(this,t)).state={sub_id:"",file:"",status:null},n.onFormSubmit=n.onFormSubmit.bind(Object(R.a)(n)),n.onChange=n.onChange.bind(Object(R.a)(n)),n}return Object(d.a)(a,[{key:"onFormSubmit",value:function(t){var e=this;t.preventDefault();var a=new FormData;a.append("sub_id",this.state.sub_id),a.append("file",this.state.file);W.post("https://api.thecatapi.com/v1/images/upload",a,{headers:{"Content-Type":"multipart/form-data","x-api-key":"98de9fca-14cc-430d-a65f-e4930c214699"}}).then((function(t){alert("The file is successfully uploaded"),e.setState({status:"success"}),t&&v.push("/")})).catch((function(t){console.log("error",t)}))}},{key:"onChange",value:function(t){this.setState({file:t.target.files[0]})}},{key:"render",value:function(){var t=this;return console.log("state vote",this.props),Object(n.jsx)("div",{className:"container upload-panel",children:Object(n.jsx)("div",{className:"card-shadow mt-5 p-4",children:Object(n.jsxs)("form",{onSubmit:this.onFormSubmit,children:[Object(n.jsx)("h1",{children:"Upload Your Cat Image"}),Object(n.jsxs)("div",{className:"form-group text-left my-4",children:[Object(n.jsx)("label",{children:"Sub Id"}),Object(n.jsx)("input",{type:"sub_id",className:"form-control",value:this.state.sub_id,onChange:function(e){return t.setState({sub_id:e.target.value})}})]}),Object(n.jsxs)("div",{className:"form-group text-left my-4",children:[Object(n.jsx)("label",{children:"Image"}),Object(n.jsx)("input",{type:"file",className:"form-control btn mt-1 p-0",id:"exampleInputPassword1",name:"file",onChange:this.onChange})]}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary btn-lg btn-block my-2",children:"Submit"})]})})})}}]),a}(i.a.Component);var Z=function(){return Object(n.jsx)("div",{className:"App",children:Object(n.jsxs)(l.b,{history:v,children:[Object(n.jsx)(g,{}),Object(n.jsx)(l.a,{exact:!0,path:"/",component:function(t){return Object(n.jsx)(Q,Object(r.a)(Object(r.a)({},t),{},{photosStore:h}))}}),Object(n.jsx)(l.a,{path:"/upload",component:function(t){return Object(n.jsx)(X,Object(r.a)(Object(r.a)({},t),{},{photosStore:h}))}})]})})},$=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,229)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),s(t),i(t),c(t)}))};o.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(Z,{})}),document.getElementById("root")),$()},65:function(t,e,a){}},[[226,1,2]]]);
//# sourceMappingURL=main.ec9354ea.chunk.js.map